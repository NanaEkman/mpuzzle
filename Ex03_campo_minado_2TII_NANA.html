<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="utf-8">
    <title>Campo minado</title>
    <style>
        section {
            display: grid;
            grid-template-columns: repeat(10, 50px);
            gap: 1px;
            border-radius: 10px;
        }
        
        .aberto {
            background-color: rgb(255, 100, 255);
        }
        
        .bomba {
            background-color: black;
        }
        
        div {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 50px;
            height: 50px;
            font-size: 150%;
        }
    </style>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script type="text/javascript">

    //acho que vou usar isso aqui
    //parte de sortear
    //para sortear posições dos ids das cartas
        function sortear(limite) {
            return Math.ceil(Math.random() * limite);
        }

        function sortear_minas(qtde) {
            let pos = [];
            while (pos.length < qtde) {
                let posicao = sortear(79);

                if (pos.indexOf(posicao) < 0) {
                    pos.push(posicao)
                }
            }
            return pos;
        }
     //////////////////////////////////
        
        //logica
        function naoExcecao(divNum, testeSoma){
            //aqui vem as excessões
            if (divNum == 0 & testeSoma == 9 |
                divNum == 9 & testeSoma == -9 |
                divNum == 9 & testeSoma == 1 |
                divNum == 9 & testeSoma == 11 |
                divNum == 70 & testeSoma == -11 |
                divNum == 70 & testeSoma == -1 |
                divNum == 70 & testeSoma == 9 |
                divNum%10 == 0 & testeSoma == -11 |
                divNum%10 == 0 & testeSoma == -1 |
                divNum%10 == 0 & testeSoma == 9 |
                divNum%10 == 9 & testeSoma == -9 |
                divNum%10 == 9 & testeSoma == 1 |
                divNum%10 == 9 & testeSoma == 11 ) {
                return false;
            } else {
                return true;
            }

        }
        // Posições das minas:
        var minas = sortear_minas(10);
        console.log(minas);

        $(document).ready(function(e){

            //criar os divs
            var listaTeste = [-11,-10,-9,-1,1,9,10,11]

            for (let divNum = 0; divNum < 80; divNum++) {

                let cont = 0;
                let bomba = false;

                //testar se é bomba
                for (let b = 0; b < minas.length; b++) {
                    num = minas[b]
                    if (num == divNum) {
                        bomba = true;
                    }
                }

                //se for pega class bomba
                if (bomba) {
					//precisar disso para criar as divs///////////////////////////////////////////////////////
                    let div = $("<div>");
                    div.attr("id", divNum);
                    div.addClass("bomba");
                    $("body main section").append(div);

                } else { //se não for

                    let listaNumProximos = [];
                    //rodar a lista de teste
                    for (let t = 0; t < listaTeste.length; t++) {
                        let testeSoma = listaTeste[t];
                        //tratando as excessões dos cantos
                        if(naoExcecao(divNum, testeSoma)){//se não for nenhuma das excessões 
                            //formar lista de numeros
                            listaNumProximos.push(divNum + testeSoma);
                        }
                        
                    }
                    console.log(listaNumProximos);
                
                    //percorrer e testar a lista de números vendo se um deles é bomba

                    for (var i = 0; i < listaNumProximos.length; i++) {
                        let testeBomba = listaNumProximos[i];
                        let result = minas.indexOf(testeBomba);
                        console.log(result)
                        if (result != -1) { //é bomba perto
                            //se for bomba incrementa o cont
                            cont++;
                            console.log(cont)

                        }
                    }
                
                //pega class aberta e escreve o número do cont
                
                    let div = $("<div>").text(cont);
                    div.attr("id", divNum);
                    div.addClass("aberto");

                    $("body main section").append(div);
                }
            }

        });
    </script>
</head>

<body>
    <main>
        <section>
            <!-- 
                A ideia é que o campo minado é composto de 80 "divs", cada um PODE ter um id (do tipo "00", "01", "02"... "78" e "79").
                Dez (10) dessas posições são minas, identificadas como....

                <div id=".." class="bomba"></div>

                E as outras posições devem ser inseridas como:

                <div id=".." class="aberto">8</div>

                Note que existe um número dentro da posição "aberta". Esse é o número de minas que existem em seus vizinhos adjacentes.

                
                P.S - Dentro do <section> só existem <div>. Não existe <br> ou outros. Só <div>.

            -->
        </section>
    </main>

</body>

</html>